<div *ngIf="kocList$ | async as list" class="table-wrapper">

  <div class="table-toolbar">
  <app-add-koc #addKoc></app-add-koc>

  <button class="btn" (click)="bulkCrawl(list)">
    âš¡ Bulk Crawl
  </button>

  <input
    type="text"
    placeholder="Search"
    [(ngModel)]="searchText"
    (ngModelChange)="onSearchChange($event)"
  />

  <!-- ğŸ”¹ FILTER DROPDOWN -->
  <div class="dropdown-wrapper">
    <button class="btn" (click)="toggleFilter()">
      ğŸ¯ Filter
    </button>

    <app-filter-builder
      class="dropdown-content"
      *ngIf="showFilter"
      [filters]="filters"
      (filtersChange)="onFiltersChange($event)"
    ></app-filter-builder>
  </div>

  <!-- ğŸ”¹ SORT DROPDOWN -->
  <div class="dropdown-wrapper">
    <button class="btn" (click)="toggleSort()">
      â†•ï¸ Sort
    </button>

    <app-sort-builder
      class="dropdown-content"
      *ngIf="isSortOpen"
      [sort]="sort"
      (sortChange)="onSortChange($event)"
    ></app-sort-builder>
  </div>
</div>

  <!-- TABLE -->
  <table class="koc-table">
    <thead>
      <tr>
        <th>
          <input
            type="checkbox"
            [checked]="selectAll"
            (change)="toggleSelectAll(list)"
          />
        </th>
        <th>STT</th>
        <th>TÃªn KÃªnh</th>
        <th>Link KÃªnh</th>
        <th>TrÃ¹ng</th>
        <th>NhÃ¢n ViÃªn</th>
        <th>Quáº£n LÃ½</th>
        <th>NgÃ y TÃ¬m</th>
        <th>Cast</th>
        <th>Hoa Há»“ng</th>
        <th>Ghi ChÃº</th>
        <th>NhÃ£n hÃ ng</th>
        <th>Sáº£n Pháº©m</th>
        <th>Tráº¡ng ThÃ¡i</th>
        <th>NgÃ y Gá»­i Máº«u</th>
        <th>NgÃ y Air Dá»± Kiáº¿n</th>
        <th>NgÃ y Air Thá»±c Táº¿</th>
        <th>Link Video</th>
        <th>ID Video</th>
        <th>Data Retrieval Time</th>
        <th>GMV</th>
        <th>Views</th>
        <th>Likes</th>
        <th>Comments</th>
        <th>Shares</th>
        <th>Saves</th>
        <th>Is Ad</th>
        <th>Action</th>
      </tr>
    </thead>

    <tbody>
      <tr
        *ngFor="let item of list; let i = index"
        [class.selected]="item.selected"
        (click)="toggleRow(item, list)"
      >
        <td>
          <input
            type="checkbox"
            [(ngModel)]="item.selected"
            (click)="$event.stopPropagation()"
          />
        </td>

        <td>{{ i + 1 }}</td>
        <td>{{ item.channelName }}</td>
        <td>
          <a [href]="item.linkChannel" target="_blank">
            {{ item.linkChannel }}
          </a>
        </td>

        <td>{{ item.isDuplicate ? 'TrÃ¹ng' : '' }}</td>
        <td>{{ item.staff }}</td>
        <td>{{ item.manager }}</td>
        <td>{{ item.dateFound }}</td>
        <td>{{ item.cast }}</td>
        <td>{{ item.commission }}%</td>
        <td>{{ item.note }}</td>
        <td>{{ item.labels.join(', ') }}</td>
        <td>{{ item.products.join(', ') }}</td>
        <td>{{ item.status }}</td>
        
        <td>{{ item.sampleSendDate | date:'dd-MM-yyyy' }}</td>
        <td>{{ item.expectedAirDate | date:'dd-MM-yyyy' }}</td>
        <td>{{ item.actualAirDate | date:'dd-MM-yyyy' }}</td>
        <td>{{ item.videoLink }}</td>
        <td>{{ item.videoId }}</td>
        <td>{{ item.dataRetrievalTime }}</td>
        <td>{{ item.gmv }}</td>
        
        <td>{{ item.views | number }}</td>
        <td>{{ item.likes | number }}</td>
        <td>{{ item.comments | number }}</td>
        <td>{{ item.shares | number }}</td>
        <td>{{ item.saves }}</td>
        <td>{{ item.isAd ? 'Yes' : 'No' }}</td>
        <td>
          <button (click)="edit(item); $event.stopPropagation()">âœï¸</button>
          <button (click)="remove(item); $event.stopPropagation()">ğŸ—‘ï¸</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

