<!-- <button class="open-btn" (click)="openPopup()">‚ûï Th√™m KOC</button>

<div class="popup-container" *ngIf="isPopupOpen">


  <div class="popup-header">
    <h2>{{ kocData.channelName || 'Th√™m KOC' }}</h2>
    <button class="close-btn" (click)="closePopup()">√ó</button>
  </div>


  <div class="popup-content">

    <form #kocForm="ngForm" (ngSubmit)="saveKoc()" class="form-grid">

      <div class="field-row">
        <label>T√™n K√™nh</label>
        <input type="text" [(ngModel)]="kocData.channelName" name="channelName">
      </div>

      <div class="field-row">
        <label>Link K√™nh</label>
        <input type="text" [(ngModel)]="kocData.linkChannel" name="linkChannel">
      </div>

      <div class="field-row">
        <label>Ng√†y T√¨m</label>
        <input type="date" [(ngModel)]="kocData.dateFound" name="dateFound">
      </div>

      <div class="field-row">
        <label>Tr√πng</label>
        <label class="checkbox-inline">
          <input type="checkbox" [(ngModel)]="kocData.isDuplicate" name="isDuplicate">
        </label>
      </div>

      <div class="field-row">
        <label>Nh√¢n Vi√™n</label>
        <input type="text" [(ngModel)]="kocData.staff" name="staff" readonly>
      </div>

      <div class="field-row">
        <label>Qu·∫£n L√Ω</label>
        <input type="text" [(ngModel)]="kocData.manager" name="manager" readonly>
      </div>

      <div class="field-row">
        <label>Cast</label>
        <input type="number" [(ngModel)]="kocData.cast" name="cast">
      </div>

      <div class="field-row">
        <label>Hoa H·ªìng</label>
        <input type="text" [(ngModel)]="kocData.commission" name="commission">
      </div>

      <div class="field-row">
        <label>Ghi Ch√∫</label>
        <textarea rows="1" [(ngModel)]="kocData.note" name="note"></textarea>
      </div>

      <div class="field-row">
        <label>Li√™n H·ªá L·∫°i</label>
        <input type="text" [(ngModel)]="kocData.recontact" name="recontact">
      </div>

      <div class="form-row full">
        <div class="form-field full">
          <div class="field-row">
            <label>Nh√£n H√†ng</label>

            <div class="tags-container">
   
              <span class="tag green" *ngFor="let label of kocData.labels; let i = index">
                {{ label }}
                <span class="remove" (click)="removeTag(kocData.labels, i)">√ó</span>
              </span>

    
              <select (change)="addSelectTag(kocData.labels, $event)" name="labels">
                <option value="" selected disabled>Ch·ªçn nh√£n</option>
                <option *ngFor="let l of availableLabels" [value]="l">
                  {{ l }}
                </option>
              </select>
            </div>

          </div>
        </div>
      </div>

      <div class="form-row full">
        <div class="form-field full">
          <div class="field-row">
            <label>S·∫£n Ph·∫©m</label>

            <div class="tags-container">
             
              <span class="tag pink" *ngFor="let product of kocData.products; let i = index">
                {{ product }}
                <span class="remove" (click)="removeTag(kocData.products, i)">√ó</span>
              </span>

             
              <select (change)="addSelectTag(kocData.products, $event)" name="products">
                <option value="" selected disabled>Ch·ªçn s·∫£n ph·∫©m</option>
                <option *ngFor="let p of availableProducts" [value]="p">
                  {{ p }}
                </option>
              </select>
            </div>

          </div>
        </div>
      </div>

      <div class="form-row full">
        <div class="form-field full">
          <div class="field-row">
            <label>Tr·∫°ng Th√°i</label>
            <div class="tags-container">
              <span class="tag teal" *ngIf="kocData.status">
                {{ kocData.status }} <span class="remove" (click)="kocData.status=''">√ó</span>
              </span>
              <select [(ngModel)]="kocData.status" name="status">
                <option value="" disabled>Ch·ªçn tr·∫°ng th√°i</option>
                <option *ngFor="let s of availableStatuses" [value]="s">{{ s }}</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="field-row">
        <label>Ng√†y G·ª≠i M·∫´u</label>
        <input type="date" [(ngModel)]="kocData.sampleSendDate" name="sampleSentDate">
      </div>

      <div class="field-row">
        <label>Ng√†y Air D·ª± Ki·∫øn</label>
        <input type="date" [(ngModel)]="kocData.expectedAirDate" name="expectedAirDate">
      </div>

      <div class="field-row">
        <label>Ng√†y Air Th·ª±c T·∫ø</label>
        <input type="date" [(ngModel)]="kocData.actualAirDate" name="actualAirDate">
      </div>

      <div class="field-row">
        <label>Link video TikTok</label>
        <input
          type="text"
          [(ngModel)]="kocData.videoLink"
          name="videoLink"
        />

        <button
          type="button"
          class="btn btn-secondary"
          (click)="crawlTikTok()"
          [disabled]="isCrawling"
        >
          {{ isCrawling ? 'ƒêang c√†o...' : 'C√†o d·ªØ li·ªáu' }}
        </button>
      </div>


      <div class="field-row">
        <label>ID Video TikTok</label>
        <input type="text" [(ngModel)]="kocData.videoId" name="videoId" readonly>
      </div>

      <div class="field-row">
        <label>GMV</label>
        <input type="number" [(ngModel)]="kocData.gmv" name="gmv" readonly>
      </div>

      <div class="field-row">
        <label>View</label>
        <input type="number" [(ngModel)]="kocData.views" name="views" readonly>
      </div>

      <div class="field-row">
        <label>Like</label>
        <input type="number" [(ngModel)]="kocData.likes" name="likes" readonly>
      </div>

      <div class="field-row">
        <label>Comment</label>
        <input type="number" [(ngModel)]="kocData.comments" name="comments" readonly>
      </div>

      <div class="field-row">
        <label>Share</label>
        <input type="number" [(ngModel)]="kocData.shares" name="shares" readonly>
      </div>

      <div class="field-row">
        <label>Save</label>
        <input type="number" [(ngModel)]="kocData.saves" name="saves" readonly>
      </div>

      <div class="field-row">
        <label>Title</label>
        <input type="text" [(ngModel)]="kocData.title" name="title" readonly>
      </div>

      <div class="field-row">
        <label>Data Retrieval Time</label>
        <input type="text" [(ngModel)]="kocData.dataRetrievalTime" name="dataRetrievalTime" readonly>
      </div>

      <div class="form-actions full">
        <button type="submit" class="btn-save">üíæ L∆∞u</button>
        <button type="button" class="btn-cancel" (click)="closePopup()">H·ªßy</button>
      </div>

    </form>

  </div>
</div>
 -->

<button class="open-btn" (click)="openPopup()">‚ûï Th√™m KOC</button>

<div class="popup-container" *ngIf="isPopupOpen">
  <div class="popup-header">
    <h2>{{ form.value.channelName || 'Th√™m KOC' }}</h2>
    <button class="close-btn" (click)="closePopup()">√ó</button>
  </div>

  <div class="popup-content">
    <form [formGroup]="form" (ngSubmit)="saveKoc()" class="form-grid">

      <!-- BASIC INFO -->
      <div class="field-row">
        <label>T√™n K√™nh</label>
        <input type="text" formControlName="channelName">
      </div>

      <div class="field-row">
        <label>Link K√™nh</label>
        <input type="text" formControlName="linkChannel">
      </div>

      <div class="field-row">
        <label>Ng√†y T√¨m</label>
        <input type="date" formControlName="dateFound">
      </div>

      <div class="field-row">
        <label>Tr√πng</label>
        <input type="checkbox" formControlName="isDuplicate">
      </div>

      <div class="field-row">
        <label>Nh√¢n Vi√™n</label>
        <input type="text" formControlName="staff" readonly>
      </div>

      <div class="field-row">
        <label>Qu·∫£n L√Ω</label>
        <input type="text" formControlName="manager" readonly>
      </div>

      <div class="field-row">
        <label>Cast</label>
        <input type="number" formControlName="cast">
      </div>

      <div class="field-row">
        <label>Hoa H·ªìng</label>
        <input type="text" formControlName="commission">
      </div>

      <div class="field-row">
        <label>Ghi Ch√∫</label>
        <textarea rows="1" formControlName="note"></textarea>
      </div>

      <div class="field-row">
        <label>Li√™n H·ªá L·∫°i</label>
        <input type="text" formControlName="recontact">
      </div>

      <!-- LABELS -->
      <div class="field-row">
        <label>Nh√£n h√†ng</label>
        <span class="tag green" *ngFor="let l of form.value.labels; let i=index">
          {{ l }} <span (click)="removeTag('labels', i)">√ó</span>
        </span>
        <select (change)="addSelectTag('labels', $event)">
          <option value="">Ch·ªçn nh√£n</option>
          <option *ngFor="let l of availableLabels" [value]="l">{{ l }}</option>
        </select>
      </div>

      <!-- PRODUCTS -->
      <div class="field-row">
        <label>S·∫£n ph·∫©m</label>
        <span class="tag pink" *ngFor="let p of form.value.products; let i=index">
          {{ p }} <span (click)="removeTag('products', i)">√ó</span>
        </span>
        <select (change)="addSelectTag('products', $event)">
          <option value="">Ch·ªçn s·∫£n ph·∫©m</option>
          <option *ngFor="let p of availableProducts" [value]="p">{{ p }}</option>
        </select>
      </div>

      <!-- STATUS -->
      <div class="field-row">
        <label>Tr·∫°ng th√°i</label>
        <select formControlName="status">
          <option value="">Ch·ªçn tr·∫°ng th√°i</option>
          <option *ngFor="let s of availableStatuses" [value]="s">{{ s }}</option>
        </select>
      </div>

      <!-- TIMELINE -->
      <div class="field-row">
        <label>Ng√†y G·ª≠i M·∫´u</label>
        <input type="date" formControlName="sampleSendDate">
      </div>

      <div class="field-row">
        <label>Ng√†y Air D·ª± Ki·∫øn</label>
        <input type="date" formControlName="expectedAirDate">
      </div>

      <div class="field-row">
        <label>Ng√†y Air Th·ª±c T·∫ø</label>
        <input type="date" formControlName="actualAirDate">
      </div>

      <!-- TIKTOK -->
      <div class="field-row">
        <label>Link video TikTok</label>
        <input type="text" formControlName="videoLink">
        <button type="button" (click)="crawlTikTok()" [disabled]="isCrawling">
          {{ isCrawling ? 'ƒêang c√†o...' : 'C√†o d·ªØ li·ªáu' }}
        </button>
      </div>

      <div class="field-row">
        <label>ID Video TikTok</label>
        <input type="text" formControlName="videoId" readonly>
      </div>

      <div class="field-row">
        <label>GMV</label>
        <input type="number" formControlName="gmv" readonly>
      </div>

      <div class="field-row">
        <label>View</label>
        <input type="number" formControlName="views" readonly>
      </div>

      <div class="field-row">
        <label>Like</label>
        <input type="number" formControlName="likes" readonly>
      </div>

      <div class="field-row">
        <label>Comment</label>
        <input type="number" formControlName="comments" readonly>
      </div>

      <div class="field-row">
        <label>Share</label>
        <input type="number" formControlName="shares" readonly>
      </div>

      <div class="field-row">
        <label>Save</label>
        <input type="number" formControlName="saves" readonly>
      </div>

      <div class="field-row">
        <label>Title</label>
        <input type="text" formControlName="title" readonly>
      </div>

      <div class="field-row">
        <label>Data Retrieval Time</label>
        <input type="text" formControlName="dataRetrievalTime" readonly>
      </div>

      <div class="form-actions">
        <button type="submit">üíæ L∆∞u</button>
        <button type="button" (click)="closePopup()">H·ªßy</button>
      </div>

    </form>
  </div>
</div>

