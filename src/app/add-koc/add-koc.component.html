<!-- N√öT M·ªû POPUP -->
<button class="open-btn" (click)="openPopup()">‚ûï Th√™m KOC</button>

<!-- POPUP -->
<div class="popup-container" *ngIf="isPopupOpen">

  <!-- HEADER -->
  <div class="popup-header">
    <h2>{{ kocData.channelName || 'Th√™m KOC' }}</h2>
    <button class="close-btn" (click)="closePopup()">√ó</button>
  </div>

  <!-- CONTENT -->
  <div class="popup-content">

    <form (ngSubmit)="saveKoc()" class="form-grid">

      <!-- T√äN K√äNH + LINK K√äNH -->
      <div class="field-row">
        <label>T√™n K√™nh</label>
        <input type="text" [(ngModel)]="kocData.channelName" name="channelName">
      </div>

      <div class="field-row">
        <label>Link K√™nh</label>
        <input type="text" [(ngModel)]="kocData.linkChannel" name="linkChannel">
      </div>

      <div class="field-row">
        <label>Ng√†y T√¨m</label>
        <input type="date" [(ngModel)]="kocData.dateFound" name="dateFound">
      </div>

      <div class="field-row">
        <label>Tr√πng</label>
        <label class="checkbox-inline">
          <input type="checkbox" [(ngModel)]="kocData.isDuplicate" name="isDuplicate">
        </label>
      </div>

      <div class="field-row">
        <label>Nh√¢n Vi√™n</label>
        <input type="text" [(ngModel)]="kocData.staff" name="staff" readonly>
      </div>

      <div class="field-row">
        <label>Qu·∫£n L√Ω</label>
        <input type="text" [(ngModel)]="kocData.manager" name="manager" readonly>
      </div>

      <div class="field-row">
        <label>Cast</label>
        <input type="number" [(ngModel)]="kocData.cast" name="cast">
      </div>

      <div class="field-row">
        <label>Hoa H·ªìng</label>
        <input type="text" [(ngModel)]="kocData.commission" name="commission">
      </div>

      <div class="field-row">
        <label>Ghi Ch√∫</label>
        <textarea rows="2" [(ngModel)]="kocData.note" name="note"></textarea>
      </div>

      <div class="field-row">
        <label>Li√™n H·ªá L·∫°i</label>
        <input type="text" [(ngModel)]="kocData.recontact" name="recontact">
      </div>

      <!-- NH√ÉN -->
      <div class="form-row full">
        <div class="form-field full">
          <div class="field-row">
            <label>Nh√£n</label>

            <div class="tags-container">
              <!-- CHIP -->
              <span class="tag green" *ngFor="let label of kocData.labels; let i = index">
                {{ label }}
                <span class="remove" (click)="removeTag(kocData.labels, i)">√ó</span>
              </span>

              <!-- SELECT -->
              <select (change)="addSelectTag(kocData.labels, $event)" name="labels">
                <option value="" selected disabled>Ch·ªçn nh√£n</option>
                <option *ngFor="let l of availableLabels" [value]="l">
                  {{ l }}
                </option>
              </select>
            </div>

          </div>
        </div>
      </div>

      <!-- S·∫¢N PH·∫®M -->
      <div class="form-row full">
        <div class="form-field full">
          <div class="field-row">
            <label>S·∫£n Ph·∫©m</label>

            <div class="tags-container">
              <!-- CHIP -->
              <span class="tag pink" *ngFor="let product of kocData.products; let i = index">
                {{ product }}
                <span class="remove" (click)="removeTag(kocData.products, i)">√ó</span>
              </span>

              <!-- SELECT -->
              <select (change)="addSelectTag(kocData.products, $event)" name="products">
                <option value="" selected disabled>Ch·ªçn s·∫£n ph·∫©m</option>
                <option *ngFor="let p of availableProducts" [value]="p">
                  {{ p }}
                </option>
              </select>
            </div>

          </div>
        </div>
      </div>

      <!-- TR·∫†NG TH√ÅI -->
      <div class="form-row full">
        <div class="form-field full">
          <div class="field-row">
            <label>Tr·∫°ng Th√°i</label>
            <div class="tags-container">
              <span class="tag teal" *ngIf="kocData.status">
                {{ kocData.status }} <span class="remove" (click)="kocData.status=''">√ó</span>
              </span>
              <select [(ngModel)]="kocData.status" name="status">
                <option value="" disabled>Ch·ªçn tr·∫°ng th√°i</option>
                <option *ngFor="let s of availableStatuses" [value]="s">{{ s }}</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="field-row">
        <label>Ng√†y G·ª≠i M·∫´u</label>
        <input type="date" [(ngModel)]="kocData.sampleSentDate" name="sampleSentDate">
      </div>

      <div class="field-row">
        <label>Ng√†y Air D·ª± Ki·∫øn</label>
        <input type="date" [(ngModel)]="kocData.expectedAirDate" name="expectedAirDate">
      </div>

      <div class="field-row">
        <label>Ng√†y Air Th·ª±c T·∫ø</label>
        <input type="date" [(ngModel)]="kocData.actualAirDate" name="actualAirDate">
      </div>

      <div class="field-row">
        <label>Link Video TikTok</label>
        <input type="text" [(ngModel)]="kocData.videoLink" name="videoLink">
      </div>

      <div class="field-row">
        <label>ID Video TikTok</label>
        <input type="text" [(ngModel)]="kocData.videoId" name="videoId" readonly>
      </div>

      <div class="field-row">
        <label>GMV</label>
        <input type="number" [(ngModel)]="kocData.gmv" name="gmv" readonly>
      </div>

      <div class="field-row">
        <label>View</label>
        <input type="number" [(ngModel)]="kocData.views" name="views" readonly>
      </div>

      <div class="field-row">
        <label>Like</label>
        <input type="number" [(ngModel)]="kocData.likes" name="likes" readonly>
      </div>

      <div class="field-row">
        <label>Comment</label>
        <input type="number" [(ngModel)]="kocData.comments" name="comments" readonly>
      </div>

      <div class="field-row">
        <label>Share</label>
        <input type="number" [(ngModel)]="kocData.shares" name="shares" readonly>
      </div>

      <div class="field-row">
        <label>Save</label>
        <input type="number" [(ngModel)]="kocData.saves" name="saves" readonly>
      </div>

      <div class="field-row">
        <label>Title</label>
        <input type="text" [(ngModel)]="kocData.title" name="title" readonly>
      </div>

      <div class="field-row">
        <label>Data Retrieval Time</label>
        <input type="text" [(ngModel)]="kocData.dataRetrievalTime" name="dataRetrievalTime" readonly>
      </div>

      <!-- ACTION -->
      <div class="form-actions full">
        <button type="submit" class="btn-save">üíæ L∆∞u</button>
        <button type="button" class="btn-cancel" (click)="closePopup()">H·ªßy</button>
      </div>

    </form>

  </div>
</div>
